<!DOCTYPE html>
<html>
<!-- Created with help from Prof. Andrews' code,
     especially code on tooltips and configurable scatterplot. -->
  <head>
    <meta charset="utf-8">
    <title>Emily and Jamie Final Project</title>
      <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
      <style type="text/css">
      h1{
        margin:0px;
        font-family:sans-serif;
        font-size:24px;
        text-align:center;
      }

      h2{
        margin:0px;
        font-family:sans-serif;
        font-size:18px;
        text-align:center;
      }
      .axis text{
          font-family:sans-serif;
          font-size:11px;
      }
      .axis path,
      .axis line{
        fill:none;
        stroke:gray;
        shape-rendering: crisp-edges;
      }

      /* css for putting two divs side by side */
      #container {
          margin: auto;
      }
      #visDiv {
          float: left;
      }
      #legend {
          width:110px;
          height:210px;
          float:left;
          margin:3em;
          padding:1em;
          border:5px solid black;
      }
      #legend p{
          font-family:sans-serif;
          font-size:18px;
          font-weight:bold;
      }

      #legend h3{
        margin:5px;
        font-family:sans-serif;
        font-size:18px;
        text-align:center;
      }

      #clear {
          clear: both;
      }

</style>
  </head>
  <body>
    <h1>Main Vis</h1>
    <h2>by Emily Sarich and Jamie Hand</h2>
    <div id="container">
        <div id="visDiv"></div>
        <div id="legend">
            <p>
                <h3>Regions</h3>
                <p id="regionList"></p>
            </p>
        </div>
        <div id="clear"></div>
    </div>

    <script>
      var createVis = function(data){
          width = 700;
          height = 500;
          // var regions = ['East', 'West', 'North', 'South'];
          // var years = d3.range(2005, 2015);
          // var rand = d3.random.normal(35, 20);
          // var data = regions.map(function(region){
          //   var profits = years.map(function(year){
          //       return {x: year, y:Math.max(0,rand())};
          //     });
          //     return {region:region, profits:profits};
          // });

          console.log(data);

          /* make a machine that does the stacking */
          // stack an array of objects, with x = 2005, y = num_firstyears, y0 = i
          var stack = d3.layout.stack()
                               .values(function(d){
                                 console.log(d.num_firstyears);
                                 return d.num_firstyears;
                               });

          /* actually stack the data */
          var stackedData = stack(data);

          // console.log(stackedData);
          //
          // var margin = {top: 20, right: 50, bottom: 40, left: 30};
          //   //   width = 500 - margin.left - margin.right,
          //   //   height = 500 - margin.top - margin.bottom;
          //
          // /* make x and y scales */
          // var x = d3.scale.ordinal().rangeRoundBands([0, width]);
          // var y = d3.scale.linear().rangeRound([height, 0]);
          // var color = d3.scale.category10();
          // var colorValue = function(d) {
          //     return d.ethnic_cat;
          // };
          //
          // var svg = d3.select("#visDiv").append("svg")
          //             .attr("width", width + margin.left + margin.right)
          //             .attr("height", height + margin.top + margin.bottom)
          //
          // var chart = svg.append("g")
          //             .attr("transform", "translate("+margin.left+","+margin.top+")");
          //
          // var xAxisG = chart.append("g")
          //               .attr({
          //                   "class": "axis",
          //                   "transform": "translate(0,"+height+")"
          //               });
          // var xAxis = d3.svg.axis()
          //               .scale(x)
          //               .orient("bottom");
          // var xAxisTitle = xAxisG.append("text")
          //                        .attr({
          //                            "x":width/2,
          //                            "y":(margin.bottom),
          //                            "text-anchor":"middle"
          //                        })
          //                        .text("Year");
          //
          // var yAxisG = chart.append("g")
          //               .attr({
          //                   "class": "axis"
          //                   // "transform": "translate(0,"+height+")"
          //               });
          // var yAxis = d3.svg.axis()
          //               .scale(y)
          //               .orient("left");
          // var yAxisTitle = yAxisG.append("text")
          //                        .attr({
          //                            "x":-width/2,
          //                            "y":1/2 * -margin.left,
          //                            "text-anchor":"middle",
          //                            "transform":"rotate(-90)"
          //                        })
          //                        .text("Profits");
          //
          // x.domain(stackedData[0].ethnic_cat.map(function(d) {return d.x;}));
          // y.domain([0, d3.max(stackedData,
          //     function(d){
          //         return d3.max(d.num_firstyears, function(e){
          //             return e.y0 + e.y;
          //         });
          //     })]).nice();
          //
          // var rearrangeRects = function(regionObject){
          //     var indexOfRegion = stackedData.indexOf(regionObject);
          //     /* remove from list, and append to front */
          //     stackedData.splice(indexOfRegion, 1);
          //     stackedData.unshift(regionObject);
          //     /* restack the data after rearranging it */
          //     stackedData = stack(data);
          //     layers.selectAll("rect")
          //               .transition()
          //               .duration(1000)
          //               .delay(function(d,i){return i*25;})
          //               .attr("y", function(d) {
          //                   return y(d.y + d.y0);
          //               });
          // };
          //
          //
          // var layers = chart.selectAll(".layer")
          //               .data(stackedData, function(d){
          //                   // get all regions
          //                   return d.ethnic_cat;
          //               });
          //
          // layers.enter().append("g")
          //               .attr("class", "layer")
          //               .style("fill", function(d, i) {
          //                   return color(colorValue(d)); });
          // layers.selectAll("rect")
          //               // for every region, get profits
          //               .data(function(d) {return d.num_firstyears; })
          //           .enter().append("rect")
          //               .attr("x", function(d) {return margin.left + x(d.x); })
          //               .attr("y", function(d) {return y(d.y + d.y0); })
          //               .attr("height", function(d) {
          //                   return y(d.y0) - y(d.y + d.y0);
          //               })
          //               .attr("width", x.rangeBand() - 1)
          //           .on("click", function(d){
          //               /* get this rect's parentNode (i.e. its g) */
          //               var regionObject = d3.select(this.parentNode).datum();
          //               rearrangeRects(regionObject);
          //           });
          //
          // chart.append("g")
          //       .attr("class", "axis")
          //       .attr("transform", "translate("+margin.left+","+height+")")
          //       .call(xAxis);
          //
          // chart.append("g")
          //       .attr("class", "axis")
          //       .attr("transform", "translate("+margin.left+",0)")
          //       .call(yAxis);
          //
          //
          // printRegionList = function(){
          //      var regionList = d3.select("#regionList");
          //      regionList.selectAll(".regionListElement").remove();
          //
          //      stackedData.forEach(function(regionObject){
          //          regionList.append("p")
          //                  .attr("class", "regionListElement")
          //                  .text(regionObject.ethnic_cat)
          //                  .style("color", function(d){
          //                      return color(colorValue(regionObject));
          //                  })
          //                  .on("click", function(d){
          //                      rearrangeRects(regionObject);
          //                      printNameList();
          //                  });
          //      });
          //  };
          //  printRegionList();

      };

    d3.csv("college_data.csv", createVis);

    </script>
  </body>
</html>
